/**
  * cliEngine v1.0.0
  * (c) 2018-2022 ymc
  * @license MIT
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["cli-engine"]={})}(this,(function(t){"use strict";
/**
    * cliOption v1.0.0
    * (c) 2018-2022 ymc
    * @license MIT
    */
/**
    * cliParam v1.0.0
    * (c) 2018-2022 ymc
    * @license MIT
    */
/**
    * extendString v1.0.0
    * (c) 2018-2022 ymc
    * @license MIT
    */function e(t,e={}){let n={};const s=Object.keys(t).map((e=>t[e])),o={slim:!0,modeStyle:"cli",...e};"string"===o.mode&&(o.slim=!0);for(let t=0;t<s.length;t+=1){const e=s[t],{name:i,type:r,value:l,desc:a}=e,[u,c]=i.split(/,/).map((t=>t.trim().replace(/^-*/gi,""))),p=u.length>1?u:c;if(p){if(o.noAutoCamelize||(n[p.camelize()]=l),o.slim)continue;n[p]=l}n[u]=l}return"string"===o.mode&&(n=function(t,e){const n={modeStyle:"cli",...e};let s="";return"string"===n.mode&&"cli"===n.modeStyle&&(s=Object.keys(t).map((e=>e.length>1?`--${e}=${t[e]}`:`-${e}=${t[e]}`)).join(" ")),"string"===n.mode&&"httpquery"===n.modeStyle&&(s=Object.keys(t).map((e=>`${e}=${t[e]}`)).join("&")),"string"===n.mode&&"swithoption"===n.modeStyle&&(s=Object.keys(t).map((e=>`${e}=${t[e]}`)).join(";")),s}(n,o)),n}function n(t={},e={}){const n={slim:!0,...e};return n.noAutoCamelize||Object.keys(t).forEach((e=>{const s=function(t){return t.replace(/(?:^\w|[A-Z_-]|\b\w)/g,((t,e)=>{let n="";return n=t.replace(/[-_]+/g," "),n=0!==e?n.replace(/[A-Z]/," $&"):n,0===e?n.toUpperCase():n.toLowerCase()})).replace(/\s+/g," ")}(e).replace(/(?:^\w|[A-Z]|\b\w)/g,((t,e)=>0===e?t.toLowerCase():t.toUpperCase())).replace(/\s+/g,"");s!==e&&(t[s]=t[e],n.slim&&delete t[e])})),t}
/**
    * extendString v1.0.0
    * (c) 2018-2022 ymc
    * @license MIT
    */function s(t,e=0,n=" "){return t.length>=e?String(t):s(t+n,e,n)}const{log:o}=console;function i(t,e,n={}){let s;return s=t[e]?t[e]:n,s}function r(t,e="",n=""){let s=t;return e&&n?(s=i(s,e),s=i(s,n)):e?s=i(s,e):n&&(s=i(s,n)),s}function l(t,e="",n=2){let s;return s=Array.isArray(t)?t:[t],s.join("\n").replace(/^/gim,Array(n).fill(e).join(""))}function a(t){let e=Array.isArray(t)?t:[t];const n=Math.max(...e.map((t=>t.split(" ")[0].length)));return e=e.map((t=>{const e=t.split(" ");let o=e[0];const i=e.slice(1);return o=s(o,n+6," "),`${o}${i.join(" ")}`})),e}function u(t,e=""){const n=new RegExp(` *${t}:.*`,"ig"),s=e.match(n);return s?s[0].replace(new RegExp(` *${t}:`,"i"),""):""}class c{constructor(){this.init()}init(){return this.optionMap={},this.opt="",this.relationMap={},this.cmd=new Set,this.ns=new Set,this.paramMap={},this}addOpt(t="",e="",n=""){const{optionMap:s,relationMap:o}=this,i=function(t="",e="l"){let n="";n=t.split(" ")[0].split(",").map((t=>t.replace(/^-*/gi,""))),n="s"===e.toLowerCase()?n[0]:n[1]?n[1]:n[0];return n}(t);let l=s;return l[i]=t,l=r(o,e,n),l[i]=!0,this.cmd.add(n),this.ns.add(e),this}getOpt(t,e="",n=""){const{optionMap:s,relationMap:o}=this,i=s;return this.opt=i[t],this}logOpt(){return o(this.opt),this}bindOpt(t="",e=""){return this.addOpt(this.opt,t,e),this}usage(t="",e=""){const{optionMap:n,relationMap:s}=this;let o,i,u;o=r(s,t,e),i=Object.keys(o),i=i.filter((t=>!this.cmd.has(t))),i=i.filter((t=>!this.ns.has(t))),o=n,u=Object.keys(o).filter((t=>i.includes(t))).map((t=>o[t])),u=a(u),u=l(u," ",2),u=`option:\n${u}`;let c=[...this.ns].filter((t=>t.trim())).join("|");c=c?`subns:${c}`:"";let p=[...this.cmd].filter((t=>t.trim())).join("|");p=p?`subcmd:${p}`:"";let g="usage:{ns} [option]";return c&&(g=g.replace(/\[option\]$/,"[subns] [option]")),p&&(g=g.replace(/\[option\]$/,"[subcmd] [option]")),p&&(u=`${p}\n${u}`),c&&(u=`${c}\n${u}`),u=l(u," ",2),g&&(u=`${g}\n${u}`),u}param(t,e="",n=""){const{paramMap:s}=this;return t.forEach((t=>{s[t.name]||(s[t.name]=t);const{name:o,type:i,value:r,desc:l}=t;this.addOpt(`${o} ${l}`,e,n)})),this}getBuiltinConfig(t={}){const{paramMap:n}=this;return e(n,t)}getCliFlags(t,e={}){let s;const{entrys:o}=e;return s=t.flags||o&&o.notOnlyFlags?t.flags:t,n(s,e)}getCurrentFlags(t,e={}){let s;return s={...this.getBuiltinFlags(),...this.getCliFlags(t,e)},s=n(s,e),s}camelizeFlags(t={},e={}){return n(t,e)}updateEntryOption(t,e="npm-bin",n="1.0.0"){const{usagemsg:s}=this;return function(t={},e="npm-bin",n="1.0.0",s=""){let o={};return o={...t,version:n,ns:e},s&&(o={autoSubCmd:u("subcmd",s),autoSubNs:u("subns",s)}),o}(t,e,n,s)}}function p(t={},e={}){const n={slim:!0,...e};return n.noAutoCamelize||Object.keys(t).forEach((e=>{const s=
/**
    * cliParam v1.0.0
    * (c) 2018-2022 ymc
    * @license MIT
    */
/**
    * extendString v1.0.0
    * (c) 2018-2022 ymc
    * @license MIT
    */
function(t){return t.replace(/(?:^\w|[A-Z_-]|\b\w)/g,((t,e)=>{let n="";return n=t.replace(/[-_]+/g," "),n=0!==e?n.replace(/[A-Z]/," $&"):n,0===e?n.toUpperCase():n.toLowerCase()})).replace(/\s+/g," ")}(e).replace(/(?:^\w|[A-Z]|\b\w)/g,((t,e)=>0===e?t.toLowerCase():t.toUpperCase())).replace(/\s+/g,"");s!==e&&(t[s]=t[e],n.slim&&delete t[e])})),t}
/**
    * nanoParse v0.0.1
    * (c) 2018-2022 ymc
    * @license MIT
    */
function g(t){let e=[],n=t;const s=[];t.includes("--")&&(e=t.slice(t.indexOf("--")+1),n=t.slice(0,t.indexOf("--")));const o=[];for(let t=0;t<n.length;t++){const e=n[t-1],i=n[t],r=n[t+1],l=r&&!/^--.+/.test(r)&&!/^-.+/.test(r),a=t=>{o.push([t,!l||r])};if(/^--.+=/.test(i)||/^-.=/.test(i))o.push(i.split("="));else if(/^-[^-].*/.test(i)){let t=i;if(t.includes("=")){const e=t.indexOf("=");o.push([t.slice(e-1,e),t.slice(e+1,e+2)]),t=t.slice(0,e-1)+t.slice(e+2)}const e=t.slice(1).split("").slice(0,-1);for(const t of e)o.push([t,!0]);a(t[t.length-1])}else if(/^--.+/.test(i)||/^-.+/.test(i))a(i);else{let t=o.find((t=>t[0]===e));if(!t&&/^-./.test(e)){const n=e[e.length-1];t=o.find((t=>t[0]===n))}t||s.push(i)}}const i={};for(const t of o){let e=t[0].replace(/^-{1,2}/g,""),n=t[1];e.startsWith("no-")&&[void 0,!0].includes(n)&&(e=e.slice(3),n=!1),i[e]=h(n)}return{flags:i,_:s.map((t=>h(t))),extras:e.map((t=>h(t)))}}function h(t){return!!["true",!0].includes(t)||!["false",!1].includes(t)&&(Number(t)?Number(t):t)}
/**
    * cliRunner v1.0.0
    * (c) 2018-2022 ymc
    * @license MIT
    */new c;const{log:d}=console;class m{constructor(){this.option={helpmsg:"usage:ns option",argvIndexS:2,enbaleSubCmd:!1,subcmd:"",allowAutoSubCmd:!0,autoSubCmd:"",version:"1.0.0",ns:"ycs",enbaleSubNs:!1,subns:"",allowAutoSubNs:!0,autoSubNs:""}}ns(t="ycs"){return this.option.ns=t,this}version(t="1.0.0"){return this.option.version=t,this}entry(t={},e="version,ns,autoSubCmd,autoSubNs"){const n=this;return t.option&&(n.option={...n.option,...t.option}),e.split(",").forEach((e=>{t[e]&&(n.option[e]=t[e])})),n.option.entrys=t,this}autosubcmd(t=""){return this.option.autoSubCmd=t,this}autosubns(t=""){return this.option.autoSubNs=t,this}nanoparse(t=(()=>{})){return this.option.nanoparse=t,this}checkSubnsEnable(){}checkSubCmdEnable(){}checkExpectArgvStart(){}run(t){let{entrys:e,helpmsg:n,argvIndexS:s,enbaleSubCmd:o,subcmd:i,allowAutoSubCmd:r,autoSubCmd:l,version:a,ns:u,enbaleSubNs:c,subns:p,allowAutoSubNs:g,autoSubNs:h,nanoparse:m}=this.option;!c&&g&&h&&(h=Array.isArray(h)?h:h.split("|"),c=h.includes(t[s])),c&&(p=t[s],s+=1,n=n.replace(/option$/,"subns option")),!o&&r&&l&&(l=Array.isArray(l)?l:l.split("|"),o=l.includes(t[s])),o&&(i=t[s],s+=1,n=n.replace(/option$/,"subcmd option"));let f=e;if(n=e.usage,c&&p){if(!f[p])return d(`${n}`),void d(`todo:subns:${p}`);n=f[p].usage?f[p].usage:n,a=f[p].version?f[p].version:a,f=f[p]?f[p]:()=>{}}if(o&&i){if(!f[i])return d(`${n}`),void d(`todo:subcmd:${i}`);n=f[i].usage?f[i].usage:n,a=f[i].version?f[i].version:a,f=f[i]?f[i]:()=>{}}let b=t.length<=s;if(e.enableZeroOption&&(b=t.length<s),f.enableZeroOption&&(b=t.length<s),b)return d(`${n}`),void d("error:invalid argv length");const y=(m||(t=>t))(t.slice(s)),$=y.flags;if(($.debugArgs||$.da)&&d(y),$.version||$.v)d(`${u} version:${a}`);else{if(!$.help&&!$.h)return e.notOnlyFlags||f.notOnlyFlags?f(y):f($);d(`${n}`)}}}new m;class f{constructor(){this.init()}init(){return this.too=new c,this.data={},this.ycs=new m,this.ycs.nanoparse(g),this}param(t){const{too:e}=this;return e.param(t),this}usage(...t){const{too:e,data:n}=this;return n.usage=e.usage(...t),this}option(t,e,n){const{too:s,data:o}=this;return o.option=s.updateEntryOption(t,e,n),this}entry(t,e={}){const{data:n,ycs:s}=this;return n.entry=
/**
    * cliEntry v1.0.0
    * (c) 2018-2022 ymc
    * @license MIT
    */
function(t=(()=>{}),e={}){const n={enableZeroOption:!0,notOnlyFlags:!0,...e};return t.usage=n.usage,t.option=n.option,t.enableZeroOption=n.enableZeroOption,t.notOnlyFlags=n.notOnlyFlags,t}(t,{...{usage:n.usage,option:n.option,...e}}),this}run(){const{data:t,ycs:e}=this;e.entry(t.entry),e.run(process.argv)}new(){return new f}camelizeFlags(t={},e={}){return p(t,e)}getBuiltinFlags(...t){const{too:e}=this;return e.getBuiltinConfig(...t)}getCurrentFlags(...t){let e;return e={...this.getBuiltinFlags(),...this.getCliFlags(t[0],t[1])},e=this.camelizeFlags(e,t[1]),e}getCliFlags(t,e={}){const{data:n}=this;return function(t,e={}){let n;const{entrys:s}=e;return n=t.flags||s&&s.notOnlyFlags?t.flags:t,p(n,e)}(t,{...e,entrys:n.entry})}}const b=new f;t.ycs=b,Object.defineProperty(t,"__esModule",{value:!0})}));
