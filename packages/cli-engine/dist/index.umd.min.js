/**
  * cliEngine v1.0.0
  * (c) 2018-2022 ymc
  * @license MIT
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["cli-engine"]={})}(this,(function(t){"use strict";
/**
    * extendString v1.0.0
    * (c) 2018-2022 ymc
    * @license MIT
    */function e(t){return function(t){return t.replace(/(?:^\w|[A-Z_-]|\b\w)/g,((t,e)=>{let n="";return n=t.replace(/[-_]+/g," "),n=0!==e?n.replace(/[A-Z]/," $&"):n,0===e?n.toUpperCase():n.toLowerCase()})).replace(/\s+/g," ")}(t).replace(/(?:^\w|[A-Z]|\b\w)/g,((t,e)=>0===e?t.toLowerCase():t.toUpperCase())).replace(/\s+/g,"")}function n(t,e=0,s=" "){return t.length>=e?String(t):n(t+s,e,s)}
/**
    * cliParam v1.0.0
    * (c) 2018-2022 ymc
    * @license MIT
    */function s(t,n={}){let s={};const i=Object.keys(t).map((e=>t[e])),o={slim:!0,modeStyle:"cli",...n};"string"===o.mode&&(o.slim=!0);for(let t=0;t<i.length;t+=1){const n=i[t],{name:r,type:l,value:a,desc:u}=n,[c,p]=r.split(/,/).map((t=>t.trim().replace(/^-*/gi,""))),h=c.length>1?c:p;if(h){if(o.noAutoCamelize||(s[e(h)]=a),o.slim)continue;s[h]=a}s[c]=a}return"string"===o.mode&&(s=function(t,e){const n={modeStyle:"cli",...e};let s="";return"string"===n.mode&&"cli"===n.modeStyle&&(s=Object.keys(t).map((e=>e.length>1?`--${e}=${t[e]}`:`-${e}=${t[e]}`)).join(" ")),"string"===n.mode&&"httpquery"===n.modeStyle&&(s=Object.keys(t).map((e=>`${e}=${t[e]}`)).join("&")),"string"===n.mode&&"swithoption"===n.modeStyle&&(s=Object.keys(t).map((e=>`${e}=${t[e]}`)).join(";")),s}(s,o)),s}function i(t={},n={}){const s={slim:!0,...n};return s.noAutoCamelize||Object.keys(t).forEach((n=>{const i=e(n);i!==n&&(t[i]=t[n],s.slim&&delete t[n])})),t}
/**
    * cliOption v1.0.0
    * (c) 2018-2022 ymc
    * @license MIT
    */
const{log:o}=console;function r(t,e,n={}){let s;return s=t[e]?t[e]:n,s}function l(t,e="",n=""){let s=t;return e&&n?(s=r(s,e),s=r(s,n)):e?s=r(s,e):n&&(s=r(s,n)),s}function a(t,e="",n=2){let s;return s=Array.isArray(t)?t:[t],s.join("\n").replace(/^/gim,Array(n).fill(e).join(""))}function u(t){let e=Array.isArray(t)?t:[t];const s=Math.max(...e.map((t=>t.split(" ")[0].length)));return e=e.map((t=>{const e=t.split(" ");let i=e[0];const o=e.slice(1);return i=n(i,s+6," "),`${i}${o.join(" ")}`})),e}function c(t,e=""){const n=new RegExp(` *${t}:.*`,"ig"),s=e.match(n);return s?s[0].replace(new RegExp(` *${t}:`,"i"),""):""}class p{constructor(){this.init()}init(){return this.optionMap={},this.opt="",this.relationMap={},this.cmd=new Set,this.ns=new Set,this.paramMap={},this}addOpt(t="",e="",n=""){const{optionMap:s,relationMap:i}=this,o=function(t="",e="l"){let n="";n=t.split(" ")[0].split(",").map((t=>t.replace(/^-*/gi,""))),n="s"===e.toLowerCase()?n[0]:n[1]?n[1]:n[0];return n}(t);let r=s;return r[o]=t,r=l(i,e,n),r[o]=!0,this.cmd.add(n),this.ns.add(e),this}getOpt(t,e="",n=""){const{optionMap:s,relationMap:i}=this,o=s;return this.opt=o[t],this}logOpt(){return o(this.opt),this}bindOpt(t="",e=""){return this.addOpt(this.opt,t,e),this}usage(t="",e=""){const{optionMap:n,relationMap:s}=this;let i,o,r;i=l(s,t,e),o=Object.keys(i),o=o.filter((t=>!this.cmd.has(t))),o=o.filter((t=>!this.ns.has(t))),i=n,r=Object.keys(i).filter((t=>o.includes(t))).map((t=>i[t])),r=u(r),r=a(r," ",2),r=`option:\n${r}`;let c=[...this.ns].filter((t=>t.trim())).join("|");c=c?`subns:${c}`:"";let p=[...this.cmd].filter((t=>t.trim())).join("|");p=p?`subcmd:${p}`:"";let h="usage:{ns} [option]";return c&&(h=h.replace(/\[option\]$/,"[subns] [option]")),p&&(h=h.replace(/\[option\]$/,"[subcmd] [option]")),p&&(r=`${p}\n${r}`),c&&(r=`${c}\n${r}`),r=a(r," ",2),h&&(r=`${h}\n${r}`),r}param(t,e="",n=""){const{paramMap:s}=this;return t.forEach((t=>{s[t.name]||(s[t.name]=t);const{name:i,type:o,value:r,desc:l}=t;this.addOpt(`${i} ${l}`,e,n)})),this}getBuiltinConfig(t={}){const{paramMap:e}=this;return s(e,t)}getCliFlags(t,e={}){let n;const{entrys:s}=e;return n=t.flags||s&&s.notOnlyFlags?t.flags:t,i(n,e)}getCurrentFlags(t,e={}){let n;return n={...this.getBuiltinFlags(),...this.getCliFlags(t,e)},n=i(n,e),n}camelizeFlags(t={},e={}){return i(t,e)}updateEntryOption(t,e="npm-bin",n="1.0.0"){const{usagemsg:s}=this;return function(t={},e="npm-bin",n="1.0.0",s=""){let i={};return i={...t,version:n,ns:e},s&&(i={autoSubCmd:c("subcmd",s),autoSubNs:c("subns",s)}),i}(t,e,n,s)}}
/**
    * nanoParse v0.0.1
    * (c) 2018-2022 ymc
    * @license MIT
    */
function h(t){const e=Array.isArray(t)?t:t.split(/ +/);let n=[],s=e;const i=[];e.includes("--")&&(n=e.slice(e.indexOf("--")+1),s=e.slice(0,e.indexOf("--")));const o=[];for(let t=0;t<s.length;t++){const e=s[t-1],n=s[t],r=s[t+1],l=r&&!/^--.+/.test(r)&&!/^-.+/.test(r),a=t=>{o.push([t,!l||r])};if(/^--.+=/.test(n)||/^-.=/.test(n))o.push(n.split("="));else if(/^-[^-].*/.test(n)){let t=n;if(t.includes("=")){const e=t.indexOf("=");o.push([t.slice(e-1,e),t.slice(e+1,e+2)]),t=t.slice(0,e-1)+t.slice(e+2)}const e=t.slice(1).split("").slice(0,-1);for(const t of e)o.push([t,!0]);a(t[t.length-1])}else if(/^--.+/.test(n)||/^-.+/.test(n))a(n);else{let t=o.find((t=>t[0]===e));if(!t&&/^-./.test(e)){const n=e[e.length-1];t=o.find((t=>t[0]===n))}t||i.push(n)}}const r={};for(const t of o){let e=t[0].replace(/^-{1,2}/g,""),n=t[1];e.startsWith("no-")&&[void 0,!0].includes(n)&&(e=e.slice(3),n=!1),r[e]=g(n)}return{flags:r,_:i.map((t=>g(t))),extras:n.map((t=>g(t)))}}function g(t){return!!["true",!0].includes(t)||!["false",!1].includes(t)&&(Number(t)?Number(t):t)}
/**
    * cliRunner v1.0.0
    * (c) 2018-2022 ymc
    * @license MIT
    */new p;const{log:d}=console;class m{constructor(){this.option={helpmsg:"usage:ns option",argvIndexS:2,enbaleSubCmd:!1,subcmd:"",allowAutoSubCmd:!0,autoSubCmd:"",version:"1.0.0",ns:"ycs",enbaleSubNs:!1,subns:"",allowAutoSubNs:!0,autoSubNs:""}}ns(t="ycs"){return this.option.ns=t,this}version(t="1.0.0"){return this.option.version=t,this}entry(t={},e="version,ns,autoSubCmd,autoSubNs"){const n=this;return t.option&&(n.option={...n.option,...t.option}),e.split(",").forEach((e=>{t[e]&&(n.option[e]=t[e])})),n.option.entrys=t,this}autosubcmd(t=""){return this.option.autoSubCmd=t,this}autosubns(t=""){return this.option.autoSubNs=t,this}nanoparse(t=(()=>{})){return this.option.nanoparse=t,this}checkSubnsEnable(){}checkSubCmdEnable(){}checkExpectArgvStart(){}run(t){let{entrys:e,helpmsg:n,argvIndexS:s,enbaleSubCmd:i,subcmd:o,allowAutoSubCmd:r,autoSubCmd:l,version:a,ns:u,enbaleSubNs:c,subns:p,allowAutoSubNs:h,autoSubNs:g,nanoparse:m}=this.option;!c&&h&&g&&(g=Array.isArray(g)?g:g.split("|"),c=g.includes(t[s])),c&&(p=t[s],s+=1,n=n.replace(/option$/,"subns option")),!i&&r&&l&&(l=Array.isArray(l)?l:l.split("|"),i=l.includes(t[s])),i&&(o=t[s],s+=1,n=n.replace(/option$/,"subcmd option"));let f=e;if(n=e.usage,c&&p){if(!f[p])return d(`${n}`),void d(`todo:subns:${p}`);n=f[p].usage?f[p].usage:n,a=f[p].version?f[p].version:a,f=f[p]?f[p]:()=>{}}if(i&&o){if(!f[o])return d(`${n}`),void d(`todo:subcmd:${o}`);n=f[o].usage?f[o].usage:n,a=f[o].version?f[o].version:a,f=f[o]?f[o]:()=>{}}let b=t.length<=s;if(e.enableZeroOption&&(b=t.length<s),f.enableZeroOption&&(b=t.length<s),b)return d(`${n}`),void d("error:invalid argv length");const y=(m||(t=>t))(t.slice(s)),$=y.flags;if(($.debugArgs||$.da)&&d(y),$.version||$.v)d(`${u} version:${a}`);else{if(!$.help&&!$.h)return e.notOnlyFlags||f.notOnlyFlags?f(y):f($);d(`${n}`)}}}new m;class f{constructor(){this.init()}init(){return this.too=new p,this.data={},this.ycs=new m,this.ycs.nanoparse(h),this}param(t){const{too:e}=this;return e.param(t),this}usage(...t){const{too:e,data:n}=this;return n.usage=e.usage(...t),this}option(t,e,n){const{too:s,data:i}=this;return i.option=s.updateEntryOption(t,e,n),this}entry(t,e={}){const{data:n,ycs:s}=this;return n.entry=
/**
    * cliEntry v1.0.0
    * (c) 2018-2022 ymc
    * @license MIT
    */
function(t=(()=>{}),e={}){const n={enableZeroOption:!0,notOnlyFlags:!0,...e};return t.usage=n.usage,t.option=n.option,t.enableZeroOption=n.enableZeroOption,t.notOnlyFlags=n.notOnlyFlags,t}(t,{...{usage:n.usage,option:n.option,...e}}),this}run(){const{data:t,ycs:e}=this;e.entry(t.entry),e.run(process.argv)}new(){return new f}camelizeFlags(t={},e={}){return i(t,e)}getBuiltinFlags(...t){const{too:e}=this;return e.getBuiltinConfig(...t)}getCurrentFlags(...t){let e;return e={...this.getBuiltinFlags(),...this.getCliFlags(t[0],t[1])},e=this.camelizeFlags(e,t[1]),e}getCliFlags(t,e={}){const{data:n}=this;return function(t,e={}){let n;const{entrys:s}=e;return n=t.flags||s&&s.notOnlyFlags?t.flags:t,i(n,e)}(t,{...e,entrys:n.entry})}}const b=new f;t.ycs=b,Object.defineProperty(t,"__esModule",{value:!0})}));
