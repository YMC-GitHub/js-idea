/**
  * esmLoader v1.0.0
  * (c) 2018-2022 ymc
  * @license MIT
  */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("node:path"),t=require("node:url"),n=require("node:fs");
/**
  * streamIo v1.0.0
  * (c) 2018-2022 ymc
  * @license MIT
  */
function r(e){return new Promise(((t,n)=>{let r="";e.on("data",(e=>{r+=e.toString()})).on("end",(()=>{t(r)})).on("error",n)}))}function s({stream:e,data:t}){return new Promise(((n,r)=>{e.write(t,"utf-8"),e.end(),e.on("finish",(()=>{n(t)})).on("error",r)}))}
/**
  * jsonStreamIo v1.0.0
  * (c) 2018-2022 ymc
  * @license MIT
  */class a{constructor(e,t){this.init(e,t)}async read(e={}){const{file:t}=this;let s,a;try{s=n.createReadStream(t.name),a=await r(s),a=JSON.parse(a)}catch(t){a=e}return t.data=a,a}async write(e){const{file:t,option:r}=this;let a,i=e;try{a=n.createWriteStream(t.name),e?t.data=e:i=t.data,await s({stream:a,data:JSON.stringify(i,null,2)})}catch(e){}}init(e="package.json",t={}){this.file={name:e,data:t},this.option={}}new(...e){return new a(...e)}}const i=new a;
/**
  * textStreamIo v1.0.0
  * (c) 2018-2022 ymc
  * @license MIT
  */class o{constructor(e="CHANGELO.md"){this.init(e)}async read(e=""){const{file:t}=this;let s,a;try{s=n.createReadStream(t.name),a=await r(s)}catch(t){a=e}return t.data=a,a}async write(e){const{file:t,option:r}=this;let a,i,o;switch(a=n.createWriteStream(t.name),i=t.data,r.writemode){case"override":default:o=`${e}`;break;case"append":o=`${i}\n${e}`;break;case"head":o=`${e}\n${i}`}t.data=o,await s({stream:a,data:o})}init(e="CHANGELO.md",t=""){return this.file={name:e,data:t},this.option={},this}new(...e){return new o(...e)}}const c=new o;
/**
  * compareVersion v1.0.0
  * (c) 2018-2022 ymc
  * @license MIT
  */function l(e,t){const n=`${t}`;let r=[];if(e){let e=n.split("-")[1];r=n.split("-")[0].split("."),e=e.split("."),r=r.concat(e)}else r=n.split(".");return r}function u(e){return e.map((e=>Number.isNaN(e)?e:parseInt(e)))}function f(e,t){const n=`${e}`,r=`${t}`,s=n.indexOf("-")>-1,a=r.indexOf("-")>-1;let i=l(s,n),o=l(a,r);i=u(i),o=u(o);const c=Math.max(i.length,o.length);for(let e=0;e<c;e+=1){if(3===e&&(void 0===i[e]||void 0===o[e])){if(void 0===i[e]&&Number.isNaN(o[e]))return 1;if(Number.isNaN(i[e])&&void 0===o[e])return-1}if(void 0===i[e])return-1;if(void 0===o[e])return 1;if(i[e]>o[e])return 1;if(i[e]<o[e])return-1}return 0}function d(t,n){const r=function(t){const n=e.resolve(process.cwd(),"."),{alias:r={}}=t;return Object.keys(r).forEach((t=>{const s=r[t];r[t]=function(e,t=".",n=/^<root>/i){return e.replace(n,t)}(s),r[t]=e.resolve(n,r[t])})),r}(n),s=Object.keys(r);for(let e=0;e<s.length;e+=1){const n=s[e],a=r[n];if(t.startsWith(n)){const e=new RegExp(`^${n}`),r=t.replace(e,"");t=`file:///${t=(t=`${a}/${r}`).replace(/\\/gi,"/")}`}}return t}const{log:m}=console,p=function(e="module-alias.json"){return function(e,t={}){let r;try{r=n.readFileSync(e),r=JSON.parse(r)}catch(e){r=t}return r}(e,{})}(),h=f(process.version,"14.13.1")>=0||f(process.version,"12.20.0")>=0;function w(e){w.enable&&m(e)}async function y(e,t,n){const r=[".js",".json",".ts",".tsx",".jsx"],{extensions:s=r}=t;let a,i;for(const r of s)try{return w(`[info] try reslove ${e+r}`),a=await n(e+r,t,n),a}catch(e){if(void 0===i){const{message:t}=e;e.message=e.message.replace(`${r}'`,"'"),e.stack=e.stack.replace(t,e.message),i=e}}throw i}async function g(t,n,r){let s;if(s=await async function(e,t,n){let r;w("[info] try resolve module,main,browser and other key in package.json");const s=await async function(e,t,n){const{packagejsonIndexOrder:r="jsnext -> browser"}=t,s=e.endsWith("/");let a,o,c,l;a="package.json",o=s?e+a:`${e}/${a}`,o=o.replace("file:///",""),i.init(o),c=await i.read({}),l=[c.main,c.module],"module"===c.type&&(l=[c.module,c.main]);l=[...l,...u(r)],l=l.filter((e=>e)),s||(l=l.map((e=>`/${e}`)));return l;function u(e="module -> main",t=/ ?-> ?/){return e.split(t).filter((e=>e)).map((e=>c[e])).filter((e=>e))}}(e,t);let a;if(s.length<0)return r;for(const i of s)try{return w(`[info] try resolve ${e+i}`),r=await n(e+i,t,n),r}catch(e){if(void 0===a){const{message:t}=e;e.message=e.message.replace(`${i}'`,"'"),e.stack=e.stack.replace(t,e.message),a=e}throw a}}(t,n,r),s)return s;let a="index";const o=t.endsWith("/")?a:"/index";try{return s=await y(t+o,n,r),s}catch(t){const{message:n}=t;throw t.message=t.message.replace(`${o.replace("/",e.sep)}'`,"'"),t.stack=t.stack.replace(n,t.message),t}}w.enable=!1,exports.load=async function(e,n,r){const s=e.split("?")[0];return[".md",".css",".html",".htm",".svg"].some((e=>s.endsWith(e)))?await async function(e){c.init(new t.URL(e));const n=await c.read("");return{format:"module",source:`export default ${JSON.stringify(n.toString())};`,shortCircuit:!0}}(e):r(e,n,r)},exports.resolve=async function(t,n,r,s){if(w("[info] compact node lib expression"),!h&&t.startsWith("node:")&&(t=t.slice(5)),w("[info] reslove alias"),t=d(t,p),w("[info] reslove dirs"),t.endsWith("/"))return await g(t,n,r);let a;w("[info] reslove next");try{a=await r(t,n,r)}catch(e){if(e instanceof Error&&!s){if("ERR_UNSUPPORTED_DIR_IMPORT"===e.code)return w("[info] recursive reslove dirs"),await g(t,n,r);if("ERR_MODULE_NOT_FOUND"===e.code)return w("[info] recursive reslove exts"),await y(t,n,r)}throw e}if(a.url.endsWith(".json"))return{...a,format:"json"};let{format:i}=a;if(a.url.startsWith("file://")){i=function(t){const n=e.extname(t);if(".mjs"===n||".mts"===n)return"module";if(".cjs"===n||".cts"===n)return"commonjs"}(a.url)||i}return{...a,format:i}};
