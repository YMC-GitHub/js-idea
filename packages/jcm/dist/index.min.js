/**
  * jcm v0.0.1
  * (c) 2018-2022 ymc
  * @license MIT
  */
/**
  * jcm v0.0.1
  * (c) 2018-2022 ymc
  * @license MIT
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).jcm={})}(this,(function(t){"use strict";const{log:e}=console;class i{constructor(){this.list=[],this.index=-1,this.freeze=!1}use(t={},e){let{list:i,index:o}=this;const s=!e;return s||o==e?o++:o<e&&(o=e),this.index=o,o=s?o:e,t&&(i[o]=t),this}load(){const{list:t}=this;let e={};for(let i=0;i<t.length;i++){const o=t[i];o&&(e={...e,...o})}const{freeze:i}=this;return i?Object.freeze(e):e}}class o{constructor(){this.data={},this.option={splitChar:"."}}bind(t){return t&&(this.data=t),this}split(t="."){return t&&(this.option.splitChar=t),this}conf(t="",i){if(!t)return this;let o,{data:s,option:n}=this;o=(t=t.split(n.splitChar))[t.length-1];const{length:r}=t;for(let e=0;e<r-1;e++){const i=t[e];s[i]||(s[i]={}),s=s[i]}return null==i?s[o]:(s[o]=i,e(`set ${o} ${i}`),this)}}new i,new o;class s{constructor(){this.option={},this.tool={}}getFileLoc(t){let{option:e,tool:i}=this,o=t||e.name,s=e;return s.usd||s.u?i.joinPath(i.getUserHome(),o):s.crd||s.c?o:s.wkd?i.joinPath(s.wkd,o):o}getFileLocList(t){let e=[],{option:i}=this;return e=[["usd","u"],["crd","c"],["wkd"]].map((e=>!!e.some((t=>i[t]))&&this.getFileLoc(t))).filter((t=>t)),e}magicReadConfig(t=".ymcrc.json"){let{tool:e}=this;return function(t=[".ymcrc.json"],e){const o=new i;for(let i=0;i<t.length;i++){const s=t[i];o.use(e(s))}return o.load()}(this.getFileLocList(t),e.readJson)}magicDefineConfig(t,e,i){const s=new o;return s.bind(t),s.split("/"),s.conf(e,i),s.data}comEntry(t){let{option:e,tool:i}=this,{name:o}=e,s={};switch(t){case"add":s=this.magicReadConfig(o),s=this.magicDefineConfig(s),i.addDirs(e.wkd);let t=i.joinPath(wkd,o);i.saveJson(t,s);break;case"del":break;default:s=magicReadConfig(o)}return s}}const n=new s;t.Jcm=s,t.jcm=n,Object.defineProperty(t,"__esModule",{value:!0})}));
