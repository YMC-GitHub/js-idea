/**
  * jsonStreamIo v1.0.0
  * (c) 2018-2022 ymc
  * @license MIT
  */
import{createReadStream as t,createWriteStream as n}from"node:fs";
/**
  * streamIo v1.0.0
  * (c) 2018-2022 ymc
  * @license MIT
  */class a{constructor(t,n){this.init(t,n)}async read(n={}){const{file:a}=this;let e,r;try{e=t(a.name),r=await(i=e,new Promise(((t,n)=>{let a="";i.on("data",(t=>{a+=t.toString()})).on("end",(()=>{t(a)})).on("error",n)}))),r=JSON.parse(r)}catch(t){r=n}var i;return a.data=r,r}async write(t){const{file:a,option:e}=this;let r,i=t;try{r=n(a.name),t?a.data=t:i=a.data,await function({stream:t,data:n}){return new Promise(((a,e)=>{t.write(n,"utf-8"),t.end(),t.on("finish",(()=>{a(n)})).on("error",e)}))}({stream:r,data:JSON.stringify(i,null,2)})}catch(t){}}init(t="package.json",n={}){this.file={name:t,data:n},this.option={}}new(...t){return new a(...t)}}const e=new a;export{a as JsonStream,e as jsonstream};
