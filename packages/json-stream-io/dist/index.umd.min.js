/**
  * jsonStreamIo v1.0.0
  * (c) 2018-2022 ymc
  * @license MIT
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("node:fs")):"function"==typeof define&&define.amd?define(["exports","node:fs"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["json-stream-io"]={},e.node_fs)}(this,(function(e,t){"use strict";
/**
    * streamIo v1.0.0
    * (c) 2018-2022 ymc
    * @license MIT
    */class n{constructor(e,t){this.init(e,t)}async read(e={}){const{file:n}=this;let a,o;try{a=t.createReadStream(n.name),o=await(r=a,new Promise(((e,t)=>{let n="";r.on("data",(e=>{n+=e.toString()})).on("end",(()=>{e(n)})).on("error",t)}))),o=JSON.parse(o)}catch(t){o=e}var r;return n.data=o,o}async write(e){const{file:n,option:a}=this;let o,r=e;try{o=t.createWriteStream(n.name),e?n.data=e:r=n.data,await function({stream:e,data:t}){return new Promise(((n,a)=>{e.write(t,"utf-8"),e.end(),e.on("finish",(()=>{n(t)})).on("error",a)}))}({stream:o,data:JSON.stringify(r,null,2)})}catch(e){}}init(e="package.json",t={}){this.file={name:e,data:t},this.option={}}new(...e){return new n(...e)}}const a=new n;e.JsonStream=n,e.jsonstream=a,Object.defineProperty(e,"__esModule",{value:!0})}));
