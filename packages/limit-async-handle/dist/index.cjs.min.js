"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const{log:t}=console;class s{constructor(t){this.init(t)}init(t){return this._max=t,this._count=0,this._taskQueue=[],this._debug=!1,this._cb=null,this}call(t,...s){return new Promise(((e,i)=>{const n=this._createTask(t,s,e,i);this._count>=this._max?this._taskQueue.push(n):n()}))}_createTask(t,s,e,i){return()=>{t(...s).then(e).catch(i).finally((()=>{this._next()})),this._nextTick()}}_next(){if(this._count-=1,this._taskQueue.length){this._taskQueue.shift()()}else this._debug&&t("task count = ",this._count),this._cb&&this._cb()}_nextTick(){this._count+=1,this._debug&&t("task count = ",this._count)}}const e=new s;exports.LimitAsyncHandle=s,exports.limitAsyncHandle=e;
