/**
  * moduleAlias v1.0.0
  * (c) 2018-2022 ymc
  * @license MIT
  */
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("node:fs");
/**
  * streamIo v1.0.0
  * (c) 2018-2022 ymc
  * @license MIT
  */
/**
  * jsonStreamIo v1.0.0
  * (c) 2018-2022 ymc
  * @license MIT
  */
class t{constructor(e,t){this.init(e,t)}async read(t={}){const{file:s}=this;let n,r;try{n=e.createReadStream(s.name),r=await(o=n,new Promise(((e,t)=>{let s="";o.on("data",(e=>{s+=e.toString()})).on("end",(()=>{e(s)})).on("error",t)}))),r=JSON.parse(r)}catch(e){r=t}var o;return s.data=r,r}async write(t){const{file:s,option:n}=this;let r,o=t;try{r=e.createWriteStream(s.name),t?s.data=t:o=s.data,await function({stream:e,data:t}){return new Promise(((s,n)=>{e.write(t,"utf-8"),e.end(),e.on("finish",(()=>{s(t)})).on("error",n)}))}({stream:r,data:JSON.stringify(o,null,2)})}catch(e){}}init(e="package.json",t={}){this.file={name:e,data:t},this.option={}}new(...e){return new t(...e)}}const s=new t;function n(e,t={}){const s={useRegexpPrefix:!0,useRegexpSuffix:!0,...t};if(!e.alias)return;const{alias:n}=e,r=Object.keys(n),o={};for(let e=0;e<r.length;e+=1){let t=r[e];if(t=t.trim(),!t)continue;let i=n[t];i&&(s.useRegexpSuffix&&(t=t.replace(/(\*)?$/,"*"),i=i.replace(/(\*)?$/,"*")),o[t]=[i])}return o}function r(e,t){return t.some((t=>t===e))}function o(e={},t="",s={}){const n={sep:".",...s},{val:r,sep:o}=n;let i=e;const a=t.split(o);if(a.length<=1)return i;const l=a.length-1,u=a[l];for(let e=0;e<l;e+=1){const t=a[e];i[t]||(i[t]={}),i=i[t]}return i&&void 0!==r&&(i[u]=r),i}function i(e,t,s){let n=e[t];n=n?[...new Set([...s,...n])]:s,e[t]=n}function a(e){let t=e||[];return Array.isArray(t)?t:[t]}function l(e){return e.map((e=>e.replace(/^./,"")))}exports.BabelbabelAliasDefineEng=class{constructor(){this.data={}}cwd(e){const{data:t}=this;if(!r(e,["packagejson","babelrc",""]))return this;if(""===e)delete t.cwd;else t.cwd=e;return this}root(e){if(!e)return this;let{data:{root:t}}=this;return t||(t=[]),r(e,t)||(t.push(e),this.data.root=t),this}alias(e,t,s){if(!e)return this;if(!t)return this;let{data:{alias:n}}=this;return n||(n={}),n[e]=t,this.data.alias=n,this}},exports.getModuleAliasInBabelConfig=function(e){let t={};const{plugins:s=[[]]}=e;for(let e=0;e<s.length;e+=1){const[n,r]=s[e];if("babel-plugin-module-resolver"===n){t=r;break}}return t},exports.hunmanJson=function(e,t=4){return JSON.stringify(e,null,t)},exports.jsonstream=s,exports.ma2babel=function(e,t={}){const s={useRegexpPrefix:!0,useRegexpSuffix:!0,...t};if(!e.alias)return;const{alias:n}=e,r=Object.keys(n),o={};for(let e=0;e<r.length;e+=1){let t=r[e];if(t=t.trim(),!t)continue;let i=n[t];i&&(s.useRegexpPrefix&&(t=t.replace(/^\^?/,"^")),s.useRegexpSuffix&&(t=t.replace(/\$?$/,"(.+)$"),i=i.replace(/\\?1?$/,"\\1")),o[t]=i)}return o},exports.ma2eslint=function(e,t={}){if(!e.alias)return;const{alias:s}=e,n=Object.keys(s);let r={};for(let e=0;e<n.length;e+=1){let t=n[e];if(t=t.trim(),!t)continue;const o=s[t];o&&(r[t]=[t,o])}return r=Object.values(r),r},exports.ma2jest=function(e,t={}){const s={useRegexpPrefix:!0,useRegexpSuffix:!0,...t};if(!e.alias)return;const{alias:n}=e,r=Object.keys(n),o={};for(let e=0;e<r.length;e+=1){let t=r[e];if(t=t.trim(),!t)continue;let i=n[t];i&&(s.useRegexpPrefix&&(t=t.replace(/^\^?/,"^"),i=i.replace(/^(\.\/)?/,"<rootDir>/")),s.useRegexpSuffix&&(t=t.replace(/\$?$/,"(.*?.?(js|vue)?|)$"),i=i.replace(/\\?1?$/,"$1")),o[t]=i)}return o},exports.ma2jsconfig=n,exports.ma2tsconfig=n,exports.ma2vscodeconfig=function(e,t={}){const s={useRegexpPrefix:!0,useRegexpSuffix:!0,...t};if(!e.alias)return;const{alias:n}=e,r=Object.keys(n),o={};for(let e=0;e<r.length;e+=1){let t=r[e];if(t=t.trim(),!t)continue;let i=n[t];i&&(s.useRegexpPrefix&&(i=i.replace(/^(\.\/)?/,"${workspaceFolder}/")),o[t]=i)}return o},exports.setModuleAliasToBabelConfig=function(e,t){e.plugins||(e.plugins=[]);const{plugins:s=[]}=e;let n=!1;const r=["node_modules","./"],o=["require","require.resolve","System.import","jest.genMockFromModule","jest.mock","jest.unmock","jest.doMock","jest.dontMock"];for(let e=0;e<s.length;e+=1){let[a,l]=s[e];if("babel-plugin-module-resolver"===a){l||(l={}),l={...l,...t},i(l,"transformFunctions",o),i(l,"root",r),s[e]=[a,l],n=!0;break}}if(!n){let e={...t};i(e,"transformFunctions",o),i(e,"root",r),s.push(["babel-plugin-module-resolver",e])}return e},exports.setModuleAliasToEslintConfig=function(e,t){let s;return s=o(e,"settings.import/resolver.alias",{}),s=s.alias,i(s,"extensions",[".ts",".tsx",".js",".jsx",".json",".vue"]),i(s,"extensions",a(t.extensions)),e},exports.setModuleAliasToJest=function(e,t){let s=[".ts",".tsx",".js",".jsx",".json",".vue"];return s=l(s),e.moduleNameMapper=t.map,i(e,"moduleFileExtensions",s),i(e,"moduleFileExtensions",l(a(t.extensions))),e},exports.setModuleAliasToJsconfig=function(e,t){let s=o(e,"compilerOptions");return s=s.compilerOptions,s.paths=t.map,t.root&&(s.baseUrl=t.root),e},exports.setModuleAliasToVscodeSettings=function(e,t){return e["path-intellisense.mappings"]=t,e};
